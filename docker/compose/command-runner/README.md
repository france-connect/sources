# Commands

## command-import-sandbox

As of now (2025/07/10), this is still a work in progress

> ðŸ’¡ Locally, we use `mongo-fcp-high` to simulate the input MongoDB, while importing to `mongo-fcp-low`  
> A cleaner stack could of course be built, but this is a one time import, we should not spend too much energy on this.

You have to...

### 1. Up a dedicated stack

- Complete partners stack
- mongo-fcp-high (will act as integ01 mongoDB)

```shell
dks switch import-sandbox
```

### 2. Up and run command container

```shell
dks command command-import-sp-sandbox
```

### Logs results

```shell
âžœ  fc git:(FC-2351) âœ— docker logs fc_command-import-sp-sandbox_1
2025-08-12T09:28:27: PM2 log: Launching in no daemon mode
2025-08-12T09:28:27: PM2 log: App [command-import-sp-sandbox:0] starting in -fork mode-
2025-08-12T09:28:27: PM2 log: App [command-import-sp-sandbox:0] online
{"level":30,"time":1754983709201,"pid":18,"hostname":"command-import-sp-sandbox","msg":"Logger is ready and native console is now overloaded."}
{"level":60,"time":1754983709226,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["writeOut (node:internal/process/warning:56:3)","process.onWarning (node:internal/process/warning:132:3)","process.emit (node:events:518:28)","process.emit (node:domain:489:12)","doEmitWarning (node:internal/process/warning:85:11)","process.processTicksAndRejections (node:internal/process/task_queues:89:21)"],"methodName":"writeOut()","msg":"(node:18) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version\n(Use `node --trace-warnings ...` to show where the warning was created)"}
{"level":60,"time":1754983709226,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["writeOut (node:internal/process/warning:56:3)","process.onWarning (node:internal/process/warning:132:3)","process.emit (node:events:518:28)","process.emit (node:domain:489:12)","doEmitWarning (node:internal/process/warning:85:11)","process.processTicksAndRejections (node:internal/process/task_queues:89:21)"],"methodName":"writeOut()","msg":"(node:18) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version"}
{"level":10,"time":1754983709293,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["MongooseProvider.connectionFactory (/var/www/app/main.js:9115:16)","/var/www/app/node_modules/@nestjs/mongoose/dist/mongoose-core.module.js:65:86","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"MongooseProvider.connectionFactory()","msg":"Connection"}
{"level":30,"time":1754983709304,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["HttpProxyService.onModuleInit (/var/www/app/main.js:6260:21)","MapIterator.iteratee (/var/www/app/node_modules/@nestjs/core/hooks/on-module-init.hook.js:22:43)","MapIterator.next (/var/www/app/node_modules/iterare/lib/map.js:13:39)","IteratorWithOperators.next (/var/www/app/node_modules/iterare/lib/iterate.js:21:28)","Function.from (<anonymous>)","IteratorWithOperators.toArray (/var/www/app/node_modules/iterare/lib/iterate.js:180:22)","callOperator (/var/www/app/node_modules/@nestjs/core/hooks/on-module-init.hook.js:23:10)","callModuleInitHook (/var/www/app/node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:23)","NestApplicationContext.callInitHook (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:242:50)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async /var/www/app/node_modules/@nestjs/core/nest-application-context.js:110:17"],"methodName":"HttpProxyService.onModuleInit()","msg":"Set up HTTPS proxy to: null"}
{"level":20,"time":1754983709307,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["NestFactory"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"Starting Nest application..."}
{"level":20,"time":1754983709307,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"CommandRootModule dependencies initialized"}
{"level":20,"time":1754983709307,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"ConfigModule dependencies initialized"}
{"level":20,"time":1754983709307,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"HttpModule dependencies initialized"}
{"level":20,"time":1754983709307,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"LoggerPluginsModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"CryptographyModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"DiscoveryModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"WebhooksModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"CommandRunnerModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"CqrsModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"LoggerModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"MicroservicesRmqModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"HttpProxyModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"MongooseModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"CsmrConfigClientModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"MongooseCoreModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"MongooseModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"ServiceProviderAdapterMongoModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["InstanceLoader"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:45","Array.forEach (<anonymous>)","Logger.flush (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:106:24)","NestApplicationContext.flushLogs (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:150:25)","NestApplicationContext.useLogger (/var/www/app/node_modules/@nestjs/core/nest-application-context.js:142:18)","bootstrap (/var/www/app/main.js:13930:9)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"AppModule dependencies initialized"}
{"level":20,"time":1754983709308,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["bootstrap (/var/www/app/main.js:13933:17)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"bootstrap()","msg":"Starting application..."}
{"level":20,"time":1754983709310,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["ImportSpSandboxCommand.run (/var/www/app/main.js:10281:21)","Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:47)","Command.listener [as _actionHandler] (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:494:17)","/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1296:65","Command._chainOrCall (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1193:12)","Command._parseCommand (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1296:27)","/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1082:27","Command._chainOrCall (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1193:12)","Command._dispatchSubcommand (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1078:25)","Command._parseCommand (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:1264:19)","Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:16)","CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:211:14)","CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:22)","bootstrap (/var/www/app/main.js:13934:47)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"ImportSpSandboxCommand.run()","msg":"# Begin import"}
{"level":40,"time":1754983709323,"pid":18,"hostname":"command-import-sp-sandbox","msg":"Invalid CSV line","line":{"email":"invalid_a_yopmail.com","datapassId":"690"},"errors":[{"target":{"email":"invalid_a_yopmail.com","datapassId":690},"value":"invalid_a_yopmail.com","property":"email","children":[],"constraints":{"isEmail":"email must be an email"}}],"callStack":["CsvInputService.filterOutInvalidLines (/var/www/app/main.js:10363:25)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async Promise.all (index 2)","async ArrayAsyncHelper.mapAsync (/var/www/app/main.js:187:16)","async ArrayAsyncHelper.filterAsync (/var/www/app/main.js:183:25)","async CsvInputService.loadCsv (/var/www/app/main.js:10357:24)","async ImportSpSandboxCommand.run (/var/www/app/main.js:10282:24)","async Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:24)","async Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:5)","async CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:210:9)","async CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:9)","async bootstrap (/var/www/app/main.js:13934:9)"],"methodName":"CsvInputService.filterOutInvalidLines()"}
{"level":10,"time":1754983709323,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["ServiceProviderAdapterMongoService.getList (/var/www/app/main.js:9816:25)","ImportSpSandboxCommand.run (/var/www/app/main.js:10283:51)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:24)","async Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:5)","async CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:210:9)","async CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:9)","async bootstrap (/var/www/app/main.js:13934:9)"],"methodName":"ServiceProviderAdapterMongoService.getList()","msg":"Refresh cache from DB"}
{"level":10,"time":1754983709340,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["MicroservicesRmqPublisherService.publish (/var/www/app/main.js:4628:21)","CsmrConfigClientService.publish (/var/www/app/main.js:4987:38)","ImportService.publish (/var/www/app/main.js:11455:37)","ImportService.publishAndInvite (/var/www/app/main.js:11442:20)","/var/www/app/main.js:11385:24","Array.map (<anonymous>)","ArrayAsyncHelper.mapAsync (/var/www/app/main.js:187:38)","ImportService.import (/var/www/app/main.js:11384:41)","ImportSpSandboxCommand.run (/var/www/app/main.js:10284:40)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:24)","async Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:5)","async CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:210:9)","async CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:9)","async bootstrap (/var/www/app/main.js:13934:9)"],"methodName":"MicroservicesRmqPublisherService.publish()","msg":"Ms:Publish:CONFIG_CREATE"}
{"level":20,"time":1754983709392,"pid":18,"hostname":"command-import-sp-sandbox","optionalParams":["ClientProxy"],"callStack":["NestLoggerService.log (/var/www/app/main.js:2873:21)","Logger.log (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:57:29)","descriptor.value (/var/www/app/node_modules/@nestjs/common/services/logger.service.js:171:27)","AmqpConnectionManager.<anonymous> (/var/www/app/node_modules/@nestjs/microservices/client/client-rmq.js:157:25)","AmqpConnectionManager.emit (node:events:530:35)","AmqpConnectionManager.emit (node:domain:489:12)","/var/www/app/node_modules/amqp-connection-manager/dist/cjs/AmqpConnectionManager.js:289:22","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"NestLoggerService.log()","msg":"Successfully connected to RMQ broker"}
{"level":10,"time":1754983709436,"pid":18,"hostname":"command-import-sp-sandbox","msg":"Ms:ReceiveResponse","result":{"type":"SUCCESS","meta":{"message":{"type":"CONFIG_CREATE","meta":{"instanceId":"d275ad66-bf48-4145-b72e-d78914045add","versionId":"7fab70bc-95c5-4ed8-aff1-4ef36321ea74","publicationStatus":"PENDING"},"payload":{"active":true,"claims":[],"client_id":"7a79e45107f9ccc6a3a5971d501220dc4fd9e87bb5e3fc62ce4104c756e22775","client_secret":"a970fc88b3111fcfdce515c2ee03488d8a349e5379a3ba2aa48c225dcea243a5","entityId":"a0cd64372db6ecf39c317c0c74ce90f02d8ad7d510ce054883b759d666a996bc","identityConsent":false,"idpFilterExclude":false,"idpFilterList":["8dfc4080-c90d-4234-969b-f6c961de3e90","b5e9539a-599a-4ed2-9b4f-8f4bfc5fbb64","0adf04be-536e-4986-b639-73ea8d38493e"],"name":"IMPORTED-FS-LOW","post_logout_redirect_uris":["https://fsp2-low.docker.dev-franceconnect.fr/client/logout-callback"],"redirect_uris":["https://fsp2-low.docker.dev-franceconnect.fr/oidc-callback"],"rep_scope":[],"scope":["openid","given_name","family_name","birthdate","gender","birthplace","birthcountry","email","preferred_username","profile","birth","identite_pivot","idp_birthdate","dgfip_rfr","dgfip_aft","dgfip_nbpac","dgfip_nbpart","dgfip_sitfam","dgfip_pac","droits_assurance_maladie","cnam_caisse","cnam_paiements_ij"],"environment":"SANDBOX","id_token_encrypted_response_alg":"","id_token_encrypted_response_enc":"","id_token_signed_response_alg":"RS256","userinfo_encrypted_response_alg":"","userinfo_encrypted_response_enc":"","userinfo_signed_response_alg":"RS256","type":"public","platform":"CORE_FCP","signupId":"1337","title":"Imported FS","createdVia":"COMMAND_IMPORT_SP_SANDBOX","createdBy":"unknown-cli-user"}}},"payload":{"type":"CONFIG_CREATE","meta":{"instanceId":"d275ad66-bf48-4145-b72e-d78914045add","versionId":"7fab70bc-95c5-4ed8-aff1-4ef36321ea74","publicationStatus":"PENDING"},"payload":{"active":true,"claims":[],"client_id":"7a79e45107f9ccc6a3a5971d501220dc4fd9e87bb5e3fc62ce4104c756e22775","client_secret":"a970fc88b3111fcfdce515c2ee03488d8a349e5379a3ba2aa48c225dcea243a5","entityId":"a0cd64372db6ecf39c317c0c74ce90f02d8ad7d510ce054883b759d666a996bc","identityConsent":false,"idpFilterExclude":false,"idpFilterList":["8dfc4080-c90d-4234-969b-f6c961de3e90","b5e9539a-599a-4ed2-9b4f-8f4bfc5fbb64","0adf04be-536e-4986-b639-73ea8d38493e"],"name":"IMPORTED-FS-LOW","post_logout_redirect_uris":["https://fsp2-low.docker.dev-franceconnect.fr/client/logout-callback"],"redirect_uris":["https://fsp2-low.docker.dev-franceconnect.fr/oidc-callback"],"rep_scope":[],"scope":["openid","given_name","family_name","birthdate","gender","birthplace","birthcountry","email","preferred_username","profile","birth","identite_pivot","idp_birthdate","dgfip_rfr","dgfip_aft","dgfip_nbpac","dgfip_nbpart","dgfip_sitfam","dgfip_pac","droits_assurance_maladie","cnam_caisse","cnam_paiements_ij"],"environment":"SANDBOX","id_token_encrypted_response_alg":"","id_token_encrypted_response_enc":"","id_token_signed_response_alg":"RS256","userinfo_encrypted_response_alg":"","userinfo_encrypted_response_enc":"","userinfo_signed_response_alg":"RS256","type":"public","platform":"CORE_FCP","signupId":"1337","title":"Imported FS","createdVia":"COMMAND_IMPORT_SP_SANDBOX","createdBy":"unknown-cli-user"}}},"callStack":["MicroservicesRmqPublisherService.publish (/var/www/app/main.js:4634:25)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async CsmrConfigClientService.publish (/var/www/app/main.js:4987:16)","async ImportService.publish (/var/www/app/main.js:11455:9)","async ImportService.publishAndInvite (/var/www/app/main.js:11442:9)","async /var/www/app/main.js:11385:13","async Promise.all (index 0)","async ArrayAsyncHelper.mapAsync (/var/www/app/main.js:187:16)","async ImportService.import (/var/www/app/main.js:11384:9)","async ImportSpSandboxCommand.run (/var/www/app/main.js:10284:9)","async Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:24)","async Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:5)","async CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:210:9)","async CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:9)","async bootstrap (/var/www/app/main.js:13934:9)"],"methodName":"MicroservicesRmqPublisherService.publish()"}
{"level":20,"time":1754983709521,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["ImportSpSandboxCommand.run (/var/www/app/main.js:10285:21)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)","async Command.<anonymous> (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:170:24)","async Command.parseAsync (/var/www/app/node_modules/nest-commander/node_modules/commander/lib/command.js:936:5)","async CommandRunnerService.run (/var/www/app/node_modules/nest-commander/src/command-runner.service.js:210:9)","async CommandFactory.runApplication (/var/www/app/node_modules/nest-commander/src/command.factory.js:41:9)","async bootstrap (/var/www/app/main.js:13934:9)"],"methodName":"ImportSpSandboxCommand.run()","msg":"# End import"}
{"level":20,"time":1754983709521,"pid":18,"hostname":"command-import-sp-sandbox","callStack":["bootstrap (/var/www/app/main.js:13941:17)","process.processTicksAndRejections (node:internal/process/task_queues:105:5)"],"methodName":"bootstrap()","msg":"Application has finished running"}
2025-08-12T09:28:29: PM2 log: App [command-import-sp-sandbox:0] exited with code [0] via signal [SIGINT]
2025-08-12T09:28:33: PM2 log: 0 application online, retry = 3
2025-08-12T09:28:35: PM2 log: 0 application online, retry = 2
2025-08-12T09:28:37: PM2 log: 0 application online, retry = 1
2025-08-12T09:28:39: PM2 log: 0 application online, retry = 0
2025-08-12T09:28:39: PM2 log: PM2 successfully stopped
```
