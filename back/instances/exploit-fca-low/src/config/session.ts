/* istanbul ignore file */

// Tested by DTO
import { ConfigParser } from '@fc/config';
import { OidcClientRoutes } from '@fc/oidc-client';
import { SessionConfig } from '@fc/session';

const env = new ConfigParser(process.env, 'Session');

export default {
  encryptionKey: env.string('USERINFO_CRYPT_KEY'),
  prefix: 'EXPLOIT-FCA-LOW-SESS:',
  cookieOptions: {
    signed: true,
    sameSite: 'Strict',
    httpOnly: true,
    secure: true,
    maxAge: 600000, // 10 minutes
    domain: process.env.FQDN,
  },
  cookieSecrets: env.json('COOKIE_SECRETS'),
  sessionCookieName: 'exploit_fca_low_session_id',
  lifetime: 600, // 10 minutes
  sessionIdLength: 64,
  slidingExpiration: true,
  excludedRoutes: [OidcClientRoutes.WELL_KNOWN_KEYS],
} as SessionConfig;
