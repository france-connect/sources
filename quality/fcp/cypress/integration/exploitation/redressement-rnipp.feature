#language: fr
@exploitation @redressementRNIPP @ignoreLow
Fonctionnalité: Redressement RNIPP
  # En tant qu'exploitant,
  # je veux rechercher un usager dans le RNIPP
  # afin de vérifier ses informations et le statut de son compte

  Scénario: Redressement RNIPP - lancer une recherche
    Etant donné que j'utilise un compte usager "par défaut"
    Et que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Quand j'effectue un redressement RNIPP pour l'usager
    Alors le message d'erreur RNIPP n'est pas affiché
    Et le numéro de ticket support est affiché
    Et les informations RNIPP de l'usager sont affichées
    Et le code retour RNIPP est "2"
    Et je m'assure d'avoir quitté le service d'exploitation

  @ci
  Scénario: Redressement RNIPP - dernière connexion
    Etant donné que j'utilise un compte usager "pour le test de dernière connexion"
    Et que l'usager peut se connecter à FranceConnect
    Et que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Quand j'effectue un redressement RNIPP pour l'usager
    Alors le statut de l'usager est "actif"
    Et la date de dernière connexion est correcte
    Et le numéro du compte usager est affiché
    Et je m'assure d'avoir quitté le service d'exploitation

  @ci
  Scénario: Redressement RNIPP - usager n'ayant jamais utilisé FranceConnect
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "n'ayant jamais utilisé FranceConnect"
    Quand j'effectue un redressement RNIPP pour l'usager
    Alors le message d'erreur RNIPP n'est pas affiché
    Et le numéro de ticket support est affiché
    Et les informations RNIPP de l'usager sont affichées
    Et le code retour RNIPP est "2"
    Et l'usager est inconnu de FranceConnect

  Plan du Scénario: Redressement RNIPP - usager <userType>
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "<userType>"
    Quand j'effectue un redressement RNIPP pour l'usager avec l'erreur "<errorCode>"
    Alors le message d'erreur RNIPP est affiché avec le code retour "<rnippStatus>"

    Exemples:
      | userType                         | errorCode | rnippStatus |
      | avec erreur RNIPP mauvais format | E010012   |             |

  Plan du Scénario: Redressement RNIPP - usager <userType>
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "<userType>"
    Quand j'effectue un redressement RNIPP pour l'usager avec l'erreur "<errorCode>"
    Alors le message d'erreur RNIPP n'est pas affiché
    Et le numéro de ticket support est affiché
    Et le code retour RNIPP est "<rnippStatus>"

    Exemples:
      | userType                              | errorCode | rnippStatus |
      | non trouvé avec un echo RNIPP         | E010004   | 4           |
      | non trouvé avec plusieurs echos RNIPP | E010006   | 6           |
      | non trouvé avec aucun echo RNIPP      | E010008   | 8           |
      | avec erreur RNIPP mauvaise requête    | E010009   | 9           |

  Plan du Scénario: Redressement RNIPP - usager <userType>
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "<userType>"
    Quand j'effectue un redressement RNIPP pour l'usager avec l'erreur "<errorCode>"
    Alors le message d'erreur RNIPP n'est pas affiché
    Et le numéro de ticket support est affiché
    Et les informations RNIPP de l'usager sont affichées
    Et le code retour RNIPP est "<rnippStatus>"

    Exemples:
      | userType                       | errorCode | rnippStatus |
      | sans nom de naissance          | E010013   | 2           |
      | avec date de naissance erronée | E010014   | 2           |

  Plan du Scénario: Redressement RNIPP - usager <userType>
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "<userType>"
    Quand j'effectue un redressement RNIPP pour l'usager avec l'erreur "<errorCode>"
    Alors le message d'erreur RNIPP n'est pas affiché
    Et l'usager est déclaré "<userType>"

    Exemples:
      | userType | errorCode | rnippStatus |
      | décédé   | E010015   | 2           |
      | décédée  | E010016   | 2           |

  Plan du Scénario: Redressement RNIPP - usager "<userType>"
    Etant donné que je navigue sur la page login d'exploitation
    Et que je me connecte à exploitation en tant que "exploitant"
    Et que je navigue vers la page redressement RNIPP
    Et que j'utilise un compte usager "<userType>"
    Quand j'effectue un redressement RNIPP pour l'usager
    Alors le message d'erreur RNIPP n'est pas affiché
    Et le numéro de ticket support est affiché
    Et les informations RNIPP de l'usager sont affichées
    Et le code retour RNIPP est "2"

    @ci
    Exemples:
      | userType                |
      | né dans l'Aisne         |
      | né en Algérie           |
      | présumé né jour         |
 
    Exemples:
      | userType                |
      | né en Corse             |
      | né en Algérie           |
      | présumé né jour et mois |


